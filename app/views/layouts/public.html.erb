<!DOCTYPE html>
<html lang="en" class="h-full bg-white dark:bg-gray-950">
  <head>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= render "layouts/meta" %>

    <%# Three-way dark mode toggle â€” prevent FOUC %>
    <script>
      document.documentElement.classList.toggle(
        "dark",
        localStorage.theme === "dark" ||
          (!("theme" in localStorage) && window.matchMedia("(prefers-color-scheme: dark)").matches)
      );
    </script>

    <%= stylesheet_link_tag :tailwind, "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag :application, "data-turbo-track": "reload" %>

    <script async src="https://ga.jspm.io/npm:es-module-shims@1.8.2/dist/es-module-shims.js" data-turbo-track="reload"></script>
    <%= javascript_importmap_tags %>

    <meta name="view-transition" content="same-origin">
    <%= yield(:head) %>
  </head>
  <body class="h-full bg-white dark:bg-gray-950 text-gray-900 dark:text-gray-100">
    <%= render "layouts/messages" %>

    <div class="flex min-h-full flex-col justify-center py-12 sm:px-6 lg:px-8">
      <%# Logo %>
      <div class="sm:mx-auto sm:w-full sm:max-w-md">
        <%= link_to root_path, class: "flex justify-center" do %>
          <div class="size-12 rounded-lg bg-blue-600 dark:bg-blue-500 flex items-center justify-center">
            <span class="text-white font-bold text-2xl">M</span>
          </div>
        <% end %>
      </div>

      <%# Content %>
      <div class="mt-8 sm:mx-auto sm:w-full sm:max-w-md">
        <div class="bg-white dark:bg-gray-900 px-4 py-8 shadow sm:rounded-lg sm:px-10">
          <%= yield %>
        </div>
      </div>
    </div>

    <%= render "layouts/modal" %>
  </body>
</html>
